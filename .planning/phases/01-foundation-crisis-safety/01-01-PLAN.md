---
phase: 01-foundation-crisis-safety
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - next.config.ts
  - biome.json
  - tailwind.config.ts
  - postcss.config.mjs
  - .env.local
  - .env.example
  - .gitignore
  - src/app/globals.css
  - src/app/layout.tsx
  - src/app/page.tsx
  - src/components/layout/Header.tsx
  - src/components/layout/Footer.tsx
  - src/components/layout/SkipLink.tsx
  - src/components/crisis/CrisisBanner.tsx
  - src/lib/utils.ts
  - components.json
autonomous: true

must_haves:
  truths:
    - "User can load the homepage and see a complete layout with header, main content area, and footer"
    - "User can navigate the entire site using only keyboard (Tab, Enter, Escape)"
    - "User can see crisis resources (988 Lifeline, Crisis Text Line, VA Crisis Line) on every page without scrolling"
    - "Homepage loads under 500KB initial bundle on Slow 3G connection"
    - "Screen reader users hear skip navigation link and all elements have proper ARIA labels"
  artifacts:
    - path: "src/app/layout.tsx"
      provides: "Root layout with CrisisBanner, Header, Footer, SkipLink on every page"
      contains: "CrisisBanner"
    - path: "src/components/crisis/CrisisBanner.tsx"
      provides: "Always-visible sticky crisis resource bar with tel: and sms: links"
      contains: "988"
    - path: "src/components/layout/Header.tsx"
      provides: "Accessible header with navigation and proper ARIA roles"
      contains: "role"
    - path: "src/components/layout/Footer.tsx"
      provides: "Accessible footer with site information"
      contains: "footer"
    - path: "src/components/layout/SkipLink.tsx"
      provides: "Skip to main content link for keyboard/screen reader users"
      contains: "skip"
    - path: "src/app/page.tsx"
      provides: "Homepage with accessible content"
      min_lines: 15
    - path: "package.json"
      provides: "Project dependencies and scripts"
      contains: "next"
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/components/crisis/CrisisBanner.tsx"
      via: "import and render in layout"
      pattern: "import.*CrisisBanner"
    - from: "src/app/layout.tsx"
      to: "src/components/layout/Header.tsx"
      via: "import and render in layout"
      pattern: "import.*Header"
    - from: "src/app/layout.tsx"
      to: "src/components/layout/Footer.tsx"
      via: "import and render in layout"
      pattern: "import.*Footer"
    - from: "src/app/layout.tsx"
      to: "src/components/layout/SkipLink.tsx"
      via: "import and render in layout"
      pattern: "import.*SkipLink"
    - from: "src/components/crisis/CrisisBanner.tsx"
      to: "988 Lifeline"
      via: "tel: link"
      pattern: "tel:988"
---

<objective>
Initialize the Next.js project with all foundation dependencies and create the accessible layout shell with always-visible crisis resources on every page.

Purpose: Establish the project foundation (FOUND-01, FOUND-04, CRISIS-01) so that from the very first page load, veterans see a complete, accessible layout with immediate access to crisis help. Performance baseline is set from day one with proper Next.js configuration.

Output: Running Next.js application with accessible layout (header, footer, skip navigation) and sticky crisis banner showing 988 Lifeline, Crisis Text Line, and VA Crisis Line on every page.
</objective>

<execution_context>
@/Users/vincecain/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vincecain/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/STACK.md
@.planning/research/ARCHITECTURE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Next.js project with dependencies and tooling</name>
  <files>
    package.json
    tsconfig.json
    next.config.ts
    biome.json
    tailwind.config.ts
    postcss.config.mjs
    .env.local
    .env.example
    .gitignore
    src/app/globals.css
    src/lib/utils.ts
    components.json
  </files>
  <action>
    Initialize a new Next.js 16 project with TypeScript, Tailwind CSS 4, and App Router:

    ```bash
    npx create-next-app@latest . --typescript --tailwind --app --use-npm --src-dir --no-import-alias
    ```

    If the directory is not empty, initialize manually by creating files. The key configuration:

    **next.config.ts:**
    - Enable React strict mode
    - Configure image optimization (formats: ['avif', 'webp'])
    - Add bundle analyzer support for performance verification

    **Install core dependencies:**
    ```bash
    npm install @supabase/supabase-js @supabase/ssr
    npm install zustand
    npm install zod
    npm install clsx tailwind-merge
    npm install lucide-react
    npm install sonner
    ```

    **Install dev dependencies:**
    ```bash
    npm install -D @biomejs/biome
    npm install -D vitest @vitejs/plugin-react jsdom
    npm install -D @testing-library/react @testing-library/jest-dom @testing-library/user-event
    npm install -D @types/node @types/react @types/react-dom
    ```

    **Initialize shadcn/ui:**
    ```bash
    npx shadcn@latest init
    ```
    Choose: New York style, Zinc base color, CSS variables. This creates components.json and sets up the ui/ component directory.

    **Add shadcn/ui Button component** (needed immediately for crisis banner):
    ```bash
    npx shadcn@latest add button
    ```

    **Initialize Biome:**
    ```bash
    npx @biomejs/biome init
    ```
    Configure biome.json with:
    - formatter.indentStyle: "tab" (or "space" with indentWidth: 2 - match project preference)
    - linter enabled with recommended rules
    - organizeImports enabled
    - files.ignore: ["node_modules", ".next", "dist"]

    **Create src/lib/utils.ts** with the cn() utility:
    ```typescript
    import { type ClassValue, clsx } from "clsx";
    import { twMerge } from "tailwind-merge";

    export function cn(...inputs: ClassValue[]) {
      return twMerge(clsx(inputs));
    }
    ```

    **Create .env.example** with placeholder values:
    ```
    NEXT_PUBLIC_SUPABASE_URL=your-supabase-url
    NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
    SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
    ```

    **Create .env.local** with same placeholders (will be filled by user later).

    **Update .gitignore** to include:
    ```
    .env.local
    .env*.local
    ```

    **Add npm scripts** to package.json:
    ```json
    "scripts": {
      "dev": "next dev --turbopack",
      "build": "next build",
      "start": "next start",
      "lint": "biome check .",
      "lint:fix": "biome check --write .",
      "format": "biome format --write .",
      "test": "vitest run",
      "test:watch": "vitest"
    }
    ```

    Do NOT install libraries that are only needed in later phases (Drizzle, React Hook Form, TanStack Query, Playwright, Resend, etc.). Install them when their phase arrives. Only install what Phase 1 actually uses.
  </action>
  <verify>
    Run `npm run build` to confirm the project compiles without errors.
    Run `npm run dev` briefly to confirm the dev server starts.
    Confirm `node_modules` exists and key packages are installed: `ls node_modules/@supabase node_modules/next node_modules/lucide-react`.
    Confirm biome.json, components.json, and tailwind config all exist.
  </verify>
  <done>
    Next.js project initializes, builds successfully, and dev server starts. All Phase 1 dependencies installed. Biome, shadcn/ui, and Tailwind configured. No unused dependencies installed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create accessible layout shell with crisis banner</name>
  <files>
    src/app/layout.tsx
    src/app/page.tsx
    src/app/globals.css
    src/components/layout/Header.tsx
    src/components/layout/Footer.tsx
    src/components/layout/SkipLink.tsx
    src/components/crisis/CrisisBanner.tsx
  </files>
  <action>
    Build the layout shell that wraps every page with accessible navigation, crisis resources, and proper semantic HTML.

    **src/components/layout/SkipLink.tsx:**
    - Render an anchor link "Skip to main content" that targets `#main-content`
    - Visually hidden by default (sr-only), visible on focus (not:sr-only on focus)
    - Must be the FIRST focusable element in the DOM
    - Use proper focus styling: high contrast outline, positioned at top-left of viewport

    **src/components/crisis/CrisisBanner.tsx:**
    - Sticky banner at the TOP of every page (position: sticky, top: 0, z-50)
    - Background: dark, high-contrast (e.g., bg-red-900 or bg-slate-900 with red accent)
    - Contains three crisis resources in a row (flex, responsive):
      1. **988 Suicide & Crisis Lifeline**: `<a href="tel:988">` with phone icon. Text: "988 Lifeline" on mobile, "Call 988 Suicide & Crisis Lifeline" on desktop
      2. **Crisis Text Line**: `<a href="sms:741741&body=HELLO">` with message icon. Text: "Text 741741" on mobile, "Text HOME to 741741" on desktop
      3. **VA Crisis Line**: `<a href="tel:18002738255">` with phone icon. Text: "VA Crisis" on mobile, "VA Crisis Line: 1-800-273-8255" on desktop
    - Each link must have:
      - `aria-label` with full descriptive text (for screen readers regardless of visual breakpoint)
      - Focus ring visible against dark background (focus-visible:ring-2 ring-white)
      - Underline on hover
    - Include visually hidden text: "If you are in crisis or need immediate help:"
    - The banner must NOT be dismissible (it is always present)
    - Use lucide-react icons: `Phone`, `MessageCircle`
    - Keep the banner compact: single line on desktop, wrapping on mobile. Max height ~40-48px on desktop.
    - Add `role="banner"` and `aria-label="Crisis resources"` to the container

    **src/components/layout/Header.tsx:**
    - Semantic `<header>` element with `role="banner"` (Note: only one role="banner" per page, so use aria-label to differentiate from crisis banner if needed, or omit role since <header> is implicit banner)
    - Site title/logo: "Veteran Resource Management" linking to `/`
    - Navigation with `<nav aria-label="Main navigation">`
    - For now, minimal nav items: Home, (placeholder links for Directory, Screening - will be built later)
    - Mobile-responsive: hamburger menu on small screens using shadcn/ui Sheet or simple toggle
    - All interactive elements keyboard-accessible with visible focus indicators
    - Skip to content target: the header comes AFTER the skip link and crisis banner in DOM order

    **src/components/layout/Footer.tsx:**
    - Semantic `<footer>` element
    - Crisis resources repeated (always one click away per requirements)
    - Copyright and organization info
    - Link to privacy policy (placeholder `/privacy`)
    - Accessible: all links have descriptive text, proper contrast

    **src/app/layout.tsx:**
    - HTML lang="en"
    - Set metadata: title "Veteran Resource Management", description about connecting veterans to resources
    - Font: use next/font for Inter or system fonts (no external font loading to save bandwidth - FOUND-04)
    - DOM order (top to bottom):
      1. `<SkipLink />`
      2. `<CrisisBanner />`
      3. `<Header />`
      4. `<main id="main-content" tabIndex={-1}>{children}</main>`
      5. `<Footer />`
    - The `<main>` element has `id="main-content"` for skip link target and `tabIndex={-1}` so it can receive focus
    - Wrap with `<Toaster />` from sonner for future notification support

    **src/app/page.tsx:**
    - Simple homepage with:
      - Heading: "Connecting Veterans to Resources" (h1)
      - Brief description of the platform
      - Call-to-action placeholder (will link to screening in Phase 3)
      - Hero section with accessible heading hierarchy (h1, h2, etc.)
    - No heavy images or assets (performance - FOUND-04)
    - Use semantic HTML throughout

    **src/app/globals.css:**
    - Tailwind CSS imports (@tailwind base, components, utilities) or Tailwind 4 @import syntax
    - CSS custom properties for crisis banner colors (consistent theming)
    - Focus-visible styles for accessibility
    - Ensure body has min-height: 100vh for footer positioning

    **WCAG 2.1 AA Checklist for this task:**
    - Color contrast ratio >= 4.5:1 for normal text, >= 3:1 for large text
    - All interactive elements have visible focus indicators
    - Skip navigation link present and functional
    - Proper heading hierarchy (single h1 per page)
    - All images have alt text (or are decorative with alt="")
    - All links have descriptive text (no "click here")
    - Semantic HTML elements used (header, nav, main, footer)
    - ARIA labels on landmarks and interactive elements
    - Touch targets minimum 44x44px on mobile
  </action>
  <verify>
    1. Run `npm run build` - must compile without errors.
    2. Run `npm run dev` and open http://localhost:3000.
    3. Verify crisis banner is visible at top of page with three crisis resource links.
    4. Verify keyboard navigation: Tab through all interactive elements, confirm focus indicators visible.
    5. Verify the skip link: Tab once from page load, "Skip to main content" should appear, Enter should move focus to main content.
    6. Verify responsive: resize browser to mobile width, crisis banner should still show all three resources (may wrap).
    7. Verify crisis links: tel:988, sms:741741, tel:18002738255 are correct href values.
    8. Run `npx next build` and check output for bundle size - initial JS should be under 100KB (well within 500KB budget).
  </verify>
  <done>
    Every page shows crisis banner with 988 Lifeline, Crisis Text Line, and VA Crisis Line. Layout has accessible header, footer, skip link, and main content area. All elements keyboard-navigable with visible focus indicators. Homepage loads with semantic HTML and proper heading hierarchy. Bundle size well under 500KB.
  </done>
</task>

</tasks>

<verification>
1. **FOUND-01 (Accessible Layout):** Homepage has header, footer, main content area. Semantic HTML elements used. Skip link works. Keyboard navigation complete. Focus indicators visible.
2. **FOUND-04 (Performance):** `next build` output shows initial JS bundle under 100KB. No external fonts loaded. No heavy assets. Turbopack enabled for dev.
3. **CRISIS-01 (Crisis Banner):** Sticky crisis banner visible on every page (rendered in root layout.tsx). Contains 988 Lifeline, Crisis Text Line, VA Crisis Line. Links use tel: and sms: protocols. Banner cannot be dismissed.
4. **WCAG 2.1 AA:** Color contrast meets ratios. All interactive elements focusable. ARIA labels on landmarks. Screen reader-compatible.
</verification>

<success_criteria>
- `npm run build` succeeds with zero errors
- Homepage renders with header, main content, footer, and crisis banner
- Crisis banner contains working links to 988 (tel:), Crisis Text Line (sms:), and VA Crisis Line (tel:)
- Tab key navigates through: skip link -> crisis links -> header nav -> main content -> footer links
- Initial JS bundle under 100KB per `next build` output
- Biome linting passes: `npm run lint` shows no errors
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-crisis-safety/01-01-SUMMARY.md`
</output>
